mode: rule

proxies:
  - name: "PROXY"
    type: trojan
    server: server.icql.work
    port: 443
    password:
    udp: true

rule-providers:
  icql-proxy:
    type: http
    behavior: domain
    url: "https://icql.work/document/9999_file/clash_rule-icql-proxy.txt"
    path: ./ruleset/icql-proxy.yaml
    interval: 86400

  icql-direct:
    type: http
    behavior: domain
    url: "https://icql.work/document/9999_file/clash_rule-icql-direct.txt"
    path: ./ruleset/icql-direct.yaml
    interval: 86400

  icql-reject:
    type: http
    behavior: domain
    url: "https://icql.work/document/9999_file/clash_rule-icql-reject.txt"
    path: ./ruleset/icql-reject.yaml
    interval: 86400

  reject:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"
    path: ./ruleset/reject.yaml
    interval: 86400

  icloud:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt"
    path: ./ruleset/icloud.yaml
    interval: 86400

  apple:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt"
    path: ./ruleset/apple.yaml
    interval: 86400

  google:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt"
    path: ./ruleset/google.yaml
    interval: 86400

  proxy:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"
    path: ./ruleset/proxy.yaml
    interval: 86400

  direct:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"
    path: ./ruleset/direct.yaml
    interval: 86400

  private:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"
    path: ./ruleset/private.yaml
    interval: 86400

  gfw:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"
    path: ./ruleset/gfw.yaml
    interval: 86400

  greatfire:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/greatfire.txt"
    path: ./ruleset/greatfire.yaml
    interval: 86400

  tld-not-cn:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt"
    path: ./ruleset/tld-not-cn.yaml
    interval: 86400

  telegramcidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt"
    path: ./ruleset/telegramcidr.yaml
    interval: 86400

  cncidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: ./ruleset/cncidr.yaml
    interval: 86400

  lancidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"
    path: ./ruleset/lancidr.yaml
    interval: 86400

  applications:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"
    path: ./ruleset/applications.yaml
    interval: 86400

  adblock:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Advertising/Advertising_Domain.txt"
    path: ./ruleset/adblock.yaml
    interval: 86400

rules:
  - RULE-SET,icql-direct,DIRECT
  - RULE-SET,icql-reject,REJECT
  - RULE-SET,icql-proxy,PROXY
  - RULE-SET,applications,DIRECT
  - DOMAIN,clash.razord.top,DIRECT
  - DOMAIN,yacd.haishan.me,DIRECT
  - RULE-SET,private,DIRECT
  - RULE-SET,reject,REJECT
  - RULE-SET,tld-not-cn,PROXY
  - RULE-SET,gfw,PROXY
  - RULE-SET,greatfire,PROXY
  - RULE-SET,telegramcidr,PROXY
  - RULE-SET,adblock,REJECT
  - MATCH,DIRECT

#rules:
#  - RULE-SET,applications,DIRECT
#  - DOMAIN,clash.razord.top,DIRECT
#  - DOMAIN,yacd.haishan.me,DIRECT
#  - RULE-SET,private,DIRECT
#  - RULE-SET,reject,REJECT
#  - RULE-SET,icloud,DIRECT
#  - RULE-SET,apple,DIRECT
#  - RULE-SET,google,DIRECT
#  - RULE-SET,proxy,PROXY
#  - RULE-SET,direct,DIRECT
#  - RULE-SET,lancidr,DIRECT
#  - RULE-SET,cncidr,DIRECT
#  - RULE-SET,telegramcidr,PROXY
#  - GEOIP,LAN,DIRECT
#  - GEOIP,CN,DIRECT
#  - MATCH,PROXY

#http:
#  mitm:
#    - "app.bilibili.com"
#    - "api.bilibili.com"
#    - "api.live.bilibili.com"
#    - "api.vc.bilibili.com"
#    - "api.weibo.cn"
#    - "mapi.weibo.com"
#    - "*.uve.weibo.com"
#  rewrite:
#    - ^https?:\/\/api\.bilibili\.com\/x\/v2\/dm\/ad - reject
#    - ^https?:\/\/api\.bilibili\.com\/pgc\/season\/app\/related\/recommend\? - reject
#    - ^https?:\/\/api\.vc\.bilibili\.com\/search_svr\/v\d\/Search\/recommend_words - reject
#    - ^https?:\/\/api\.vc\.bilibili\.com\/topic_svr\/v1\/topic_svr - reject
#    - ^https?:\/\/api\.vc\.bilibili\.com\/dynamic_svr\/v1\/dynamic_svr\/mix_uplist - reject
#    - ^https?:\/\/api\.bilibili\.com\/pgc\/season\/app\/related\/recommend\? - reject
#    - ^https?:\/\/manga\.bilibili\.com\/twirp\/comic\.v\d\.Comic\/Flash - reject
#    - ^https?:\/\/manga\.bilibili\.com\/twirp\/comic\.v\d\.Comic\/ListFlash - reject
#  script:
#    #b站
#    - match: ^https?:\/\/app\.bilibili\.com\/x\/v2\/feed\/index
#      name: bilibili_plus
#      type: response
#      require-body: true
#      timeout: 10
#    - match: https?:\/\/api\.live\.bilibili\.com\/xlive\/app-room\/v1\/index\/getInfoByRoom
#      name: bilibili_plus
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https?:\/\/api\.bilibili\.com\/pgc\/page\/bangumi
#      name: bilibili_plus
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https?:\/\/api\.vc\.bilibili\.com\/dynamic_svr\/v1\/dynamic_svr\/dynamic_(history|new)\?
#      name: bilibili_plus
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https?:\/\/app\.bilibili\.com\/x\/v2\/splash\/list
#      name: bilibili_plus
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https?:\/\/app\.bilibili\.com\/x\/resource\/show\/tab
#      name: bilibili_plus
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https?:\/\/app\.bilibili\.com\/x\/v2\/account\/mine
#      name: bilibili_plus
#      type: response
#      require-body: true
#      timeout: 10
#    #微博
#    - match: ^https?://(sdk|wb)app\.uve\.weibo\.com(/interface/sdk/sdkad.php|/wbapplua/wbpullad.lua)
#      name: wb
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https?://m?api\.weibo\.c(n|om)/2/(statuses/(unread|extend|positives/get|(friends|video)(/|_)(mix)?timeline)|stories/(video_stream|home_list)|(groups|fangle)/timeline|profile/statuses|comments/build_comments|photo/recommend_list|service/picfeed|searchall|cardlist|page|!/photos/pic_recommend_status|video/tiny_stream_video_list|photo/info)
#      name: wb2
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https://(api\.weibo\.cn|mapi\.weibo\.com)/2/comments/build_comments\?
#      name: weibo_comment
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https://(api\.weibo\.cn|mapi\.weibo\.com)/2/(statuses/unread_hot_timeline|statuses/friends/timeline|video/tiny_stream_video_list|statuses/unread_friends_timeline)\?
#      name: weibo_statuses
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https://(api\.weibo\.cn|mapi\.weibo\.com)/2/(searchall|page)\?
#      name: weibo_cardlist
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https://(api\.weibo\.cn|mapi\.weibo\.com)/2/cardlist\?
#      name: weibo_cardlist_discover
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https://(api\.weibo\.cn|mapi\.weibo\.com)/2/statuses/extend\?
#      name: weibo_statuses_extend
#      type: response
#      require-body: true
#      timeout: 10
#    - match: ^https://sdkapp\.uve\.weibo\.com/interface/sdk/sdkad\.php$
#      name: weibo_sdkad
#      type: response
#      require-body: true
#      timeout: 10
#
#script-providers:
#  #b站
#  bilibili_plus:
#    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_plus.js
#    interval: 86400
#  #贴吧
#  smile_tieba_json:
#    url: https://raw.githubusercontent.com/app2smile/rules/master/js/tieba-json.js
#    interval: 86400
#  smile_tieba_proto:
#    url: https://raw.githubusercontent.com/app2smile/rules/master/js/tieba-proto.js
#    interval: 86400
#  #微博
#  wb:
#    url: https://raw.githubusercontent.com/yichahucha/surge/master/wb_launch.js
#    interval: 86400
#  wb2:
#    url: https://raw.githubusercontent.com/yichahucha/surge/master/wb_ad.js
#    interval: 86400
#  weibo_comment:
#    url: https://raw.githubusercontent.com/yjqiang/surge_scripts/main/scripts/weibo/weibo_comment.js
#    interval: 86400
#  weibo_statuses:
#    url: https://raw.githubusercontent.com/yjqiang/surge_scripts/main/scripts/weibo/weibo_statuses.js
#    interval: 86400
#  weibo_cardlist:
#    url: https://raw.githubusercontent.com/yjqiang/surge_scripts/main/scripts/weibo/weibo_cardlist.js
#    interval: 86400
#  weibo_cardlist_discover:
#    url: https://raw.githubusercontent.com/yjqiang/surge_scripts/main/scripts/weibo/weibo_cardlist_discover.js
#    interval: 86400
#  weibo_statuses_extend:
#    url: https://raw.githubusercontent.com/yjqiang/surge_scripts/main/scripts/weibo/weibo_statuses_extend.js
#    interval: 86400
#  weibo_sdkad:
#    url: https://raw.githubusercontent.com/yjqiang/surge_scripts/main/scripts/weibo/weibo_sdkad.js
#    interval: 86400